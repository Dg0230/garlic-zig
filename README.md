# Garlic Java Decompiler (Zig Implementation)

ä¸€ä¸ªç”¨ Zig 0.14 é‡æ–°å®ç°çš„é«˜æ€§èƒ½ Java åç¼–è¯‘å™¨ï¼ŒåŸºäºåŸå§‹çš„ C è¯­è¨€ç‰ˆæœ¬ Garlic åç¼–è¯‘å™¨ã€‚

## é¡¹ç›®æ¦‚è¿°

Garlic-Zig æ˜¯å¯¹åŸå§‹ C è¯­è¨€ Garlic Java åç¼–è¯‘å™¨çš„ç°ä»£åŒ–é‡å†™ï¼Œåˆ©ç”¨ Zig è¯­è¨€çš„ä¼˜åŠ¿æä¾›æ›´å¥½çš„æ€§èƒ½ã€å†…å­˜å®‰å…¨å’Œè·¨å¹³å°æ”¯æŒã€‚

### ä¸»è¦ç‰¹æ€§

- ğŸš€ **é«˜æ€§èƒ½**: åˆ©ç”¨ Zig çš„ç¼–è¯‘æ—¶ä¼˜åŒ–å’Œé›¶æˆæœ¬æŠ½è±¡
- ğŸ›¡ï¸ **å†…å­˜å®‰å…¨**: ç¼–è¯‘æ—¶å†…å­˜å®‰å…¨æ£€æŸ¥ï¼Œé¿å…ç¼“å†²åŒºæº¢å‡ºå’Œå†…å­˜æ³„æ¼
- ğŸŒ **è·¨å¹³å°**: æ”¯æŒ Windowsã€macOSã€Linux ç­‰å¤šä¸ªå¹³å°
- ğŸ“¦ **å¤šæ ¼å¼æ”¯æŒ**: æ”¯æŒ Java Classã€JARã€DEX æ–‡ä»¶
- ğŸ§µ **å¹¶å‘å¤„ç†**: å¤šçº¿ç¨‹åç¼–è¯‘ï¼Œå……åˆ†åˆ©ç”¨å¤šæ ¸å¤„ç†å™¨
- ğŸ“ **è¯¦ç»†æ—¥å¿—**: å®Œæ•´çš„æ—¥å¿—ç³»ç»Ÿï¼Œä¾¿äºè°ƒè¯•å’Œç›‘æ§
- âš™ï¸ **çµæ´»é…ç½®**: æ”¯æŒå¤šç§é…ç½®æ ¼å¼ï¼ˆJSONã€INIã€YAMLã€TOMLï¼‰

## é¡¹ç›®ç»“æ„

```
garlic-zig/
â”œâ”€â”€ build.zig              # æ„å»ºé…ç½®
â”œâ”€â”€ README.md              # é¡¹ç›®æ–‡æ¡£
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ main.zig           # ä¸»å…¥å£
â”‚   â”œâ”€â”€ common/
â”‚   â”‚   â””â”€â”€ types.zig      # åŸºç¡€ç±»å‹å®šä¹‰
â”‚   â”œâ”€â”€ libs/              # åŸºç¡€è®¾æ–½åº“
â”‚   â”‚   â”œâ”€â”€ mod.zig        # åº“æ¨¡å—å…¥å£
â”‚   â”‚   â”œâ”€â”€ memory.zig     # å†…å­˜æ± ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ list.zig       # åŠ¨æ€æ•°ç»„
â”‚   â”‚   â”œâ”€â”€ hashmap.zig    # å“ˆå¸Œè¡¨
â”‚   â”‚   â”œâ”€â”€ queue.zig      # é˜Ÿåˆ—å’Œä¼˜å…ˆé˜Ÿåˆ—
â”‚   â”‚   â”œâ”€â”€ bitset.zig     # ä½é›†åˆ
â”‚   â”‚   â”œâ”€â”€ trie.zig       # å­—å…¸æ ‘
â”‚   â”‚   â”œâ”€â”€ str.zig        # å­—ç¬¦ä¸²å¤„ç†
â”‚   â”‚   â”œâ”€â”€ threadpool.zig # çº¿ç¨‹æ± 
â”‚   â”‚   â”œâ”€â”€ zip.zig        # ZIPæ–‡ä»¶å¤„ç†
â”‚   â”‚   â”œâ”€â”€ logger.zig     # æ—¥å¿—ç³»ç»Ÿ
â”‚   â”‚   â””â”€â”€ config.zig     # é…ç½®ç®¡ç†
â”‚   â”œâ”€â”€ parser/            # è§£æå™¨æ¨¡å—ï¼ˆå¾…å®ç°ï¼‰
â”‚   â”œâ”€â”€ jvm/               # JVMæ¨¡æ‹Ÿå™¨ï¼ˆå¾…å®ç°ï¼‰
â”‚   â”œâ”€â”€ decompiler/        # åç¼–è¯‘æ ¸å¿ƒï¼ˆå¾…å®ç°ï¼‰
â”‚   â””â”€â”€ codegen/           # ä»£ç ç”Ÿæˆï¼ˆå¾…å®ç°ï¼‰
â””â”€â”€ tests/                 # æµ‹è¯•æ–‡ä»¶
```

## å¼€å‘é˜¶æ®µ

### âœ… ç¬¬ä¸€é˜¶æ®µï¼šåŸºç¡€è®¾æ–½ (å·²å®Œæˆ)

- [x] é¡¹ç›®ç»“æ„æ­å»º
- [x] æ„å»ºç³»ç»Ÿé…ç½®
- [x] åŸºç¡€ç±»å‹å®šä¹‰
- [x] å†…å­˜ç®¡ç†ç³»ç»Ÿ
- [x] æ ¸å¿ƒæ•°æ®ç»“æ„ï¼ˆåˆ—è¡¨ã€å“ˆå¸Œè¡¨ã€é˜Ÿåˆ—ç­‰ï¼‰
- [x] å­—ç¬¦ä¸²å¤„ç†å·¥å…·
- [x] çº¿ç¨‹æ± å®ç°
- [x] æ–‡ä»¶å¤„ç†ï¼ˆZIPæ”¯æŒï¼‰
- [x] æ—¥å¿—ç³»ç»Ÿ
- [x] é…ç½®ç®¡ç†

### ğŸ”„ ç¬¬äºŒé˜¶æ®µï¼šè§£æå™¨æ¨¡å— (è¿›è¡Œä¸­)

- [ ] Java Class æ–‡ä»¶è§£æå™¨
- [ ] JAR æ–‡ä»¶å¤„ç†
- [ ] DEX æ–‡ä»¶æ”¯æŒ
- [ ] å¸¸é‡æ± è§£æ
- [ ] æ–¹æ³•å’Œå­—æ®µè§£æ
- [ ] å±æ€§è§£æ

### â³ ç¬¬ä¸‰é˜¶æ®µï¼šJVM æ¨¡æ‹Ÿå™¨

- [ ] å­—èŠ‚ç æŒ‡ä»¤å®šä¹‰
- [ ] æ“ä½œæ•°æ ˆæ¨¡æ‹Ÿ
- [ ] å±€éƒ¨å˜é‡è¡¨
- [ ] æ§åˆ¶æµåˆ†æ
- [ ] å¼‚å¸¸å¤„ç†

### â³ ç¬¬å››é˜¶æ®µï¼šåç¼–è¯‘æ ¸å¿ƒ

- [ ] æŠ½è±¡è¯­æ³•æ ‘ï¼ˆASTï¼‰
- [ ] è¡¨è¾¾å¼é‡å»º
- [ ] æ§åˆ¶ç»“æ„è¯†åˆ«
- [ ] å˜é‡ç±»å‹æ¨æ–­
- [ ] ä»£ç ä¼˜åŒ–

### â³ ç¬¬äº”é˜¶æ®µï¼šä»£ç ç”Ÿæˆ

- [ ] Java ä»£ç ç”Ÿæˆ
- [ ] æ ¼å¼åŒ–å’Œç¾åŒ–
- [ ] æ³¨é‡Šç”Ÿæˆ
- [ ] æºç æ˜ å°„

## æ„å»ºå’Œè¿è¡Œ

### å‰ç½®è¦æ±‚

- Zig 0.14 æˆ–æ›´é«˜ç‰ˆæœ¬
- æ”¯æŒçš„æ“ä½œç³»ç»Ÿï¼šWindowsã€macOSã€Linux

### æ„å»ºé¡¹ç›®

```bash
# å…‹éš†é¡¹ç›®
git clone <repository-url>
cd garlic-zig

# æ„å»ºé¡¹ç›®
zig build

# è¿è¡Œé¡¹ç›®
zig build run

# è¿è¡Œæµ‹è¯•
zig build test

# è¿è¡ŒåŸºå‡†æµ‹è¯•
zig build bench
```

### ä½¿ç”¨ç¤ºä¾‹

```bash
# åç¼–è¯‘å•ä¸ª Class æ–‡ä»¶
./garlic input.class -o output.java

# åç¼–è¯‘ JAR æ–‡ä»¶
./garlic input.jar -o output_dir/

# ä½¿ç”¨å¤šçº¿ç¨‹
./garlic input.jar -o output_dir/ --threads 4

# å¯ç”¨è¯¦ç»†è¾“å‡º
./garlic input.class -o output.java --verbose

# å¯ç”¨è°ƒè¯•æ¨¡å¼
./garlic input.class -o output.java --debug
```

## é…ç½®

é¡¹ç›®æ”¯æŒå¤šç§é…ç½®æ ¼å¼ï¼Œå¯ä»¥é€šè¿‡é…ç½®æ–‡ä»¶è‡ªå®šä¹‰åç¼–è¯‘è¡Œä¸ºï¼š

### JSON é…ç½®ç¤ºä¾‹

```json
{
  "output": {
    "format": "java",
    "indent": "  ",
    "line_numbers": false
  },
  "decompiler": {
    "optimize": true,
    "inline_simple_getters": true,
    "remove_bridge_methods": true
  },
  "logging": {
    "level": "info",
    "file": "garlic.log"
  }
}
```

### INI é…ç½®ç¤ºä¾‹

```ini
[output]
format = java
indent = "  "
line_numbers = false

[decompiler]
optimize = true
inline_simple_getters = true
remove_bridge_methods = true

[logging]
level = info
file = garlic.log
```

## æ€§èƒ½ç‰¹æ€§

### å†…å­˜ç®¡ç†

- **å†…å­˜æ± **: è‡ªå®šä¹‰å†…å­˜æ± å‡å°‘åˆ†é…å¼€é”€
- **é›¶æ‹·è´**: å°½å¯èƒ½é¿å…ä¸å¿…è¦çš„æ•°æ®å¤åˆ¶
- **RAII**: è‡ªåŠ¨èµ„æºç®¡ç†ï¼Œé˜²æ­¢å†…å­˜æ³„æ¼

### å¹¶å‘å¤„ç†

- **çº¿ç¨‹æ± **: å¯é…ç½®çš„å·¥ä½œçº¿ç¨‹æ•°é‡
- **ä»»åŠ¡åˆ†å‰²**: å¤§æ–‡ä»¶è‡ªåŠ¨åˆ†å‰²ä¸ºå°ä»»åŠ¡
- **è´Ÿè½½å‡è¡¡**: åŠ¨æ€ä»»åŠ¡åˆ†é…

### ä¼˜åŒ–ç­–ç•¥

- **ç¼–è¯‘æ—¶ä¼˜åŒ–**: åˆ©ç”¨ Zig çš„ comptime ç‰¹æ€§
- **ç¼“å­˜æœºåˆ¶**: æ™ºèƒ½ç¼“å­˜å¸¸ç”¨æ•°æ®
- **æƒ°æ€§åŠ è½½**: æŒ‰éœ€åŠ è½½å’Œè§£æ

## æµ‹è¯•

é¡¹ç›®åŒ…å«å®Œæ•´çš„æµ‹è¯•å¥—ä»¶ï¼š

```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
zig build test

# è¿è¡Œç‰¹å®šæ¨¡å—æµ‹è¯•
zig test src/libs/memory.zig
zig test src/libs/list.zig

# è¿è¡ŒåŸºå‡†æµ‹è¯•
zig build bench
```

## è´¡çŒ®æŒ‡å—

1. Fork é¡¹ç›®
2. åˆ›å»ºç‰¹æ€§åˆ†æ”¯ (`git checkout -b feature/amazing-feature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add some amazing feature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/amazing-feature`)
5. å¼€å¯ Pull Request

### ä»£ç è§„èŒƒ

- éµå¾ª Zig å®˜æ–¹ä»£ç é£æ ¼
- æ·»åŠ é€‚å½“çš„æ³¨é‡Šå’Œæ–‡æ¡£
- ç¡®ä¿æ‰€æœ‰æµ‹è¯•é€šè¿‡
- ä¿æŒä»£ç è¦†ç›–ç‡

## è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ - æŸ¥çœ‹ [LICENSE](LICENSE) æ–‡ä»¶äº†è§£è¯¦æƒ…ã€‚

## è‡´è°¢

- åŸå§‹ Garlic Java åç¼–è¯‘å™¨é¡¹ç›®
- Zig è¯­è¨€ç¤¾åŒº
- æ‰€æœ‰è´¡çŒ®è€…å’Œæµ‹è¯•è€…

## è”ç³»æ–¹å¼

- é¡¹ç›®ä¸»é¡µ: [GitHub Repository]
- é—®é¢˜æŠ¥å‘Š: [GitHub Issues]
- è®¨è®º: [GitHub Discussions]

---

**æ³¨æ„**: è¿™æ˜¯ä¸€ä¸ªæ­£åœ¨å¼€å‘ä¸­çš„é¡¹ç›®ï¼Œå½“å‰å¤„äºç¬¬ä¸€é˜¶æ®µï¼ˆåŸºç¡€è®¾æ–½ï¼‰å®ŒæˆçŠ¶æ€ã€‚åç»­é˜¶æ®µçš„åŠŸèƒ½å°†é€æ­¥å®ç°ã€‚